# Chronicler System Architecture: Layer-by-Layer Explanation

## 1. Blockchain Layer

**What it is:**
The layer where blockchain transactions and events originate.

**Components:**
- **Ethereum:** The primary blockchain network.
- **Smart Contracts:** Define the application logic and data structures.
- **Event Logs:** Generated by smart contracts on blockchain transactions.

**Role:**
Ensures data integrity, immutability, and consensus.

---

## 2. Indexer Layer

**What it is:**
Processes blockchain events, extracts relevant data, and prepares it for off-chain storage.

**Components:**
- **Event Watcher:** Monitors blockchain for new events.
- **Log Parser:** Analyzes event logs to extract key information.
- **Data Enricher:** Adds context, metadata, and derived metrics.

**Role:**
Transforms raw blockchain data into structured, indexed, and enriched events.

---

## 3. Off-Chain Layer

**What it is:**
Supporting infrastructure that handles data too large or too detailed for the blockchain.

**Components:**
- **Indexer:** Processes blockchain events, extracts logs, and prepares analytics.
- **IPFS Storage:** Stores detailed logs, input/output data, and batch data in a decentralized way.
- **Oracle Network:** Verifies data, provides multi-signature confirmation, and enables off-chain computation.

**Role:**
Enables scalable, detailed, and cost-effective storage and analytics, while keeping the blockchain lean.

---

## 5a. Supabase: Off-Chain Database

**What it is:**
Supabase is a hosted, scalable PostgreSQL database with a RESTful API and real-time capabilities, used as the main off-chain data store for Chronicler.

**Role in the System:**
- **Event Storage:** The Indexer service captures blockchain events and stores them in Supabase for fast querying and analytics.
- **Analytics & Metrics:** Enriched data, performance metrics, and usage analytics are stored and aggregated in Supabase.
- **Dashboard Support:** The Dashboard service queries Supabase to provide real-time monitoring, compliance reports, and user-facing analytics.
- **Oracle Verification:** The Oracle service may use Supabase to store and retrieve data for off-chain validation and consensus.

**Data Flow:**
1. Blockchain events are captured by the Indexer and written to Supabase.
2. Oracle and other services may read/write to Supabase for validation and consensus.
3. The Dashboard queries Supabase to display analytics, logs, and compliance data to users.

**Why Supabase?**
- Provides a scalable, managed PostgreSQL backend.
- Real-time subscriptions for live dashboard updates.
- RESTful and GraphQL APIs for easy integration.
- Built-in authentication and security features.

---

## 6. Monitoring & Compliance

**What it is:**
Ensures the system's reliability, security, and adherence to regulations.

**Components:**
- **Alerting:** Monitors system metrics and alerts on anomalies.
- **Logging:** Centralized logging for all system components.
- **Auditability:** Records all user actions and system events.
- **Compliance:** Adapts to changing regulations and standards.

**Role:**
Provides visibility, security, and accountability across the entire system.

---

## 7. Dashboard Layer

**What it is:**
Provides a user-friendly interface for monitoring and interacting with the system.

**Components:**
- **Frontend:** React-based UI for users.
- **Backend:** RESTful/GraphQL API for data fetching.
- **Data Sources:** Supabase, other off-chain databases, and external APIs.

**Role:**
Enables users to view data, manage settings, and receive alerts.

---